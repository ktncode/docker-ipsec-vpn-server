#!/bin/bash
#
# å®Œå…¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— & å†æ§‹ç¯‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
#

echo "================================================"
echo "VPN ã‚µãƒ¼ãƒãƒ¼ å®Œå…¨å†æ§‹ç¯‰"
echo "================================================"
echo ""

echo "ğŸ—‘ï¸  æ—¢å­˜ã‚³ãƒ³ãƒ†ãƒŠã¨ãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’å‰Šé™¤ä¸­..."
docker compose down -v 2>/dev/null || true

echo "ğŸ—‘ï¸  æ—¢å­˜ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å‰Šé™¤ä¸­..."
docker rmi ipsec-vpn-rtx1200:latest 2>/dev/null || true

echo "ğŸ”¨ ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’å†ãƒ“ãƒ«ãƒ‰ä¸­ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥ãªã—ï¼‰..."
docker compose build --no-cache

echo "ğŸš€ ã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ä¸­..."
docker compose up -d

echo ""
echo "â³ èµ·å‹•å®Œäº†ã‚’å¾…æ©Ÿä¸­..."
sleep 5

echo ""
echo "âœ… èµ·å‹•ç¢ºèªã‚’å®Ÿè¡Œã—ã¾ã™..."
echo ""

./startup-check.sh
